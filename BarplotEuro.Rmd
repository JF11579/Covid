

```{r}
options(scipen = 999)
```

```{r}
library(ggplot2)
library(tidyverse)
```
'''
# THE DATA https://docs.google.com/spreadsheets/d/e/2PACX-1vSgZnrr8yZ5Hj8-FfS_yZzgkG7VN1ywdS9QZtxdy-F3gaAZ8PXcq3NWUUEV0LYh9K_7Ye9uIxv_GkAl/pubhtml
'''

```{r}
data<- read_csv("country_pop_covid.csv")
                
```

```{r}
data$Country<- as.factor(data$Country)
```

```{r}
head(data,2)
```


```{r}
data
```


```{r}
data<-select(data,Country,Population,covid_cases)
```

```{r}
head(data)
```


```{r}
data<- data%>%
        gather("status", "number",2:3)
```

```{r}
data
```


```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status, ),width = 0.7)+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
  scale_y_log10()+
  ggtitle("Log 10")
```



```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status) , width = 0.7, position = position_stack(reverse = T))+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
  scale_y_log10()+
   guides(fill = guide_legend(reverse = TRUE))+
  ggtitle("Log 10")
```


```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status) , width = 0.7, position = position_stack(reverse = T))+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
  scale_y_continuous(trans='log2')+
   guides(fill = guide_legend(reverse = TRUE))+
  ggtitle("Log 2")
```


```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status) , width = 0.7, position = position_stack(reverse = T))+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
  guides(fill = guide_legend(reverse = TRUE))+
   scale_y_sqrt()+
  ggtitle("Square Root")
```


```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status) , width = 0.7, position = position_stack(reverse = T))+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
 scale_y_continuous(breaks = c( 0,9000000,10000000,100000000,200000000,300000000))+
  ggtitle("Messing with the breaks")
```


# You can also create your own. See ?scales::trans_new
```{r}
?scales::trans_new
```


EXample of trans_new , thisone using cubed root

#https://stackoverflow.com/questions/49248937/in-rs-scales-package-why-does-trans-new-use-the-inverse-argument

```{r}
library(scales)
```

```{r}
cube_root <- function(x) x ^ (1/3)
cube <- function(x) x ^ 3
```

```{r}
trans_cube <- trans_new(name = "cube root",
                        transform = cube_root,
                        inverse = cube)
```

# applying a transform
ggplot(plot_data, aes(x = x, y = y)) +
  geom_point() +
  coord_trans(y = trans_cube)
  
```{r}
ggplot(data, aes(x=Country, y=number))+
      geom_col(aes(fill=status) , width = 0.7, position = position_stack(reverse = T))+
  theme(axis.text.x = element_text(angle = 45, vjust = 0.75,hjust = 0.9))+
  guides(fill = guide_legend(reverse = TRUE))+
  ggtitle("Square Root")+
  coord_trans(y = trans_cube)
```


















